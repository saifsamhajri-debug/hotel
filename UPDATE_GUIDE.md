# دليل التحديث - Hotel Management System

## تحديث قاعدة البيانات

إذا كنت تقوم بتحديث النظام من نسخة قديمة، اتبع الخطوات التالية:

### الخطوة 1: إيقاف النظام
إذا كان النظام يعمل، قم بإيقافه أولاً بالضغط على `CTRL+C` في نافذة الأوامر.

### الخطوة 2: تحديث المكتبات
```bash
pip install -r requirements.txt
```

### الخطوة 3: تحديث قاعدة البيانات
```bash
python update_db.py
```

هذا السكريبت سيقوم بـ:
- إضافة حقل `actual_check_in_time` إلى جدول `bookings`
- إضافة حقل `actual_check_out_time` إلى جدول `bookings`
- إنشاء جدول `services` للخدمات الإضافية

### الخطوة 4: إعادة تشغيل النظام
```bash
python run.py
```

---

## التحديثات الجديدة (الإصدار 2.0)

### 1. أوقات تسجيل الدخول والخروج
- يتم تسجيل الوقت الفعلي تلقائياً من ساعة النظام
- يظهر في صفحة تفاصيل الحجز والفاتورة

### 2. نظام الخدمات الإضافية
- 9 خدمات متاحة (وجبات، غسيل، سبا، إلخ)
- إمكانية إضافة/حذف الخدمات للحجوزات
- حساب تلقائي للتكلفة الإجمالية

### 3. نظام الفواتير
- فاتورة تفصيلية شاملة
- طباعة مباشرة من المتصفح
- تحميل كملف PDF

### 4. تخصيص اسم الفندق
- يمكن تغيير اسم الفندق من ملف `.env`
- يظهر في القائمة الرئيسية والفواتير

---

## حل المشاكل الشائعة

### مشكلة: `no such column: bookings.actual_check_in_time`

**الحل:**
```bash
python update_db.py
```

### مشكلة: `ModuleNotFoundError: No module named 'weasyprint'`

**الحل:**
```bash
pip install weasyprint reportlab
```

### مشكلة: قاعدة البيانات تالفة

**الحل:**
1. احفظ نسخة احتياطية من `instance/hotel.db`
2. احذف ملف `instance/hotel.db`
3. قم بتشغيل:
```bash
python init_db.py
```

---

## ملاحظات مهمة

1. **النسخ الاحتياطي**: قم دائماً بعمل نسخة احتياطية من قاعدة البيانات قبل التحديث
2. **البيانات الموجودة**: التحديث لن يؤثر على البيانات الموجودة
3. **الحجوزات القديمة**: الحجوزات القديمة لن يكون لها أوقات دخول/خروج فعلية (ستكون فارغة)

---

## الدعم

إذا واجهت أي مشاكل، يرجى:
1. التحقق من ملف `FEATURES.md` للتفاصيل الكاملة
2. التحقق من ملف `README.md` لمتطلبات التشغيل
3. التأكد من تثبيت جميع المكتبات المطلوبة

